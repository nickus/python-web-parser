#!/usr/bin/env python3
"""
Демонстрация функциональности выбора вариантов
"""

import tkinter as tk
from tkinter import messagebox
import sys
import os

# Проверяем работоспособность GUI
print("Демонстрация функциональности выбора вариантов")
print("=" * 50)

try:
    from gui_app import MaterialMatcherGUI
    
    # Создаем и запускаем GUI
    print("Создание GUI приложения...")
    root = tk.Tk()
    
    # Создаем приложение 
    app = MaterialMatcherGUI(root)
    
    print("GUI приложение создано успешно!")
    print("\nДобавленная функциональность:")
    print("1. Двойной клик по варианту из прайс-листа")
    print("2. Скрытие остальных вариантов")
    print("3. Обновление названия материала с выбранным вариантом")
    print("4. Кнопка 'Сбросить выборы'")
    print("5. Кнопка 'Экспорт выбранных (Excel)'")
    
    print("\nИнструкция по использованию:")
    print("1. Загрузите материалы и прайс-лист")
    print("2. Запустите сопоставление")
    print("3. Перейдите на вкладку 'Результаты'")
    print("4. Сделайте двойной клик по любому варианту в столбце 'Вариант из прайс-листа'")
    print("5. Остальные варианты скроются, выбранный подсветится зеленым")
    print("6. Название материала обновится: 'Материал ➤ Выбранный вариант'")
    print("7. Используйте 'Экспорт выбранных' для экспорта только выбранных результатов")
    
    # Показываем информационное окно
    def show_info():
        info_text = """Функциональность выбора вариантов добавлена!

Как использовать:
• Сделайте двойной клик по варианту в столбце "Вариант из прайс-листа"
• Остальные варианты автоматически скроются
• Выбранный вариант подсветится зеленым
• Название материала обновится с выбранным вариантом
• Используйте "Экспорт выбранных" для экспорта только выбранных результатов

Кнопки управления:
• "Сбросить выборы" - сбросить все выборы
• "Экспорт выбранных (Excel)" - экспорт только выбранных вариантов"""
        
        messagebox.showinfo("Функциональность выбора вариантов", info_text)
    
    # Показываем информацию при запуске
    root.after(1000, show_info)
    
    # Запускаем GUI
    print("\nЗапуск GUI приложения...")
    print("Закройте окно приложения, чтобы завершить демонстрацию.")
    
    root.mainloop()
    
    print("\nДемонстрация завершена.")
    
except ImportError as e:
    print(f"Ошибка импорта: {e}")
    sys.exit(1)
except Exception as e:
    print(f"Ошибка: {e}")
    import traceback
    traceback.print_exc()
    sys.exit(1)